REM Generated by https://claude.ai
REM Edited by Alex Krieg
REM Installation:
REM 	1) Install https://inkscape.org
REM     2) Add Inkscape to the PATH variables (windows)
REM 		A) Search for "Systemumgebungsvariablen bearbeiten" (DE)
REM 		              "Edit the system enviroment variables" (EN)
REM 		B) Click on "Umgebungsvariablen" (DE)
REM 					"Enviroment variables" (EN)
REM 		C) In the User variable section, search for the variable "Path"
REM			   and edit it.
REM			D) Add a new entry: "C:\Program Files\Inkscape\bin" 
REM			   Or what ever location your Inkscape uses. 
REM			
REM Do not use filenames that contain spaces or brackets: "(", ")"
REM 



@echo off
setlocal

REM Adds Inkscape to the path enviroment variable for this batch call session
set "PATH=C:\Program Files\Inkscape\bin;%PATH%"

REM Simple PDF to SVG Converter for Windows
REM Works with older versions of Inkscape

if "%1"=="" (
    echo Usage: %~nx0 input.pdf [output.svg]
    echo Example: %~nx0 document.pdf
    echo Example: %~nx0 document.pdf output.svg
    exit /b 1
)

set "INPUT_PDF=%~1"
set "OUTPUT_SVG=%~2"

echo Input:  "%INPUT_PDF%"
echo Output: "%OUTPUT_SVG%"

REM Check if input file exists
if not exist "%INPUT_PDF%" (
    echo Error: Input file '%INPUT_PDF%' does not exist.
    exit /b 1
)

REM Set default output filename if not provided
if "%OUTPUT_SVG%"=="" (
    for %%f in ("%INPUT_PDF%") do set "OUTPUT_SVG=%%~dpnf.svg"
)

echo Converting: %INPUT_PDF% -^> %OUTPUT_SVG%

REM Try different Inkscape command variations
echo Trying Inkscape conversion...

REM Method 1: New Inkscape (v1.0+)
inkscape --export-type=svg --export-filename="%OUTPUT_SVG%" "%INPUT_PDF%" 2>nul
if exist "%OUTPUT_SVG%" goto :success

REM Method 2: Older Inkscape (v0.9x)
inkscape --file="%INPUT_PDF%" --export-plain-svg="%OUTPUT_SVG%" 2>nul
if exist "%OUTPUT_SVG%" goto :success

REM Method 3: Very old Inkscape
inkscape "%INPUT_PDF%" --export-plain-svg="%OUTPUT_SVG%" 2>nul
if exist "%OUTPUT_SVG%" goto :success

REM Method 4: Try ImageMagick as fallback
echo Inkscape failed, trying ImageMagick...
magick "%INPUT_PDF%" "%OUTPUT_SVG%" 2>nul
if exist "%OUTPUT_SVG%" goto :success

REM Method 5: Try with specific page for ImageMagick
magick "%INPUT_PDF%[0]" "%OUTPUT_SVG%" 2>nul
if exist "%OUTPUT_SVG%" goto :success

echo.
echo Conversion failed! Please check:
echo 1. Is Inkscape installed and in PATH?
echo 2. Is ImageMagick installed and in PATH?
echo 3. Is the PDF file valid?
echo.
echo To install tools:
echo - Inkscape: https://inkscape.org/release/
echo - ImageMagick: https://imagemagick.org/script/download.php#windows
exit /b 1

:success
echo.
echo Conversion successful!
echo Output: %OUTPUT_SVG%
for %%A in ("%OUTPUT_SVG%") do echo Size: %%~zA bytes
exit /b 0